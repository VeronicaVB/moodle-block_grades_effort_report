define ("block_grades_effort_report/controls",["jquery","core/ajax","core/log","core/templates","block_grades_effort_report/chart"],function(a,b,c,d,e){'use strict';function f(a){var b=this;b.username=a}f.prototype.main=function(){var a=this;a.trendChart();a.setupEvents()};f.prototype.trendChart=function(){for(var a=document.getElementById("trendChart"),b=document.querySelector("#performance"),c=JSON.parse(b.dataset.performance),d=[],f=[],g=[],h=[],j=[],k=[],l={avgattendance:"Average Attendance",avgeffort:"Average Effort",avggrades:"Average Grade",avgradeterm:"Average Grade"},m=0;m<c.length;m++){var n=c[m],o=n.details.year.toString(),p=n.details.term.toString();d.push(["T"+p,o]);k.push(n.details.avggrades);j.push(n.details.avggrades);h.push(n.details.avgeffort);g.push(n.details.avgattendance)}f.push({label:l.avggrades,data:j,fill:!1,borderColor:"#31326f",backgroundColor:"#31326f",tension:.1});f.push({label:l.avgeffort,data:h,fill:!1,borderColor:"#ffc93c",backgroundColor:"#ffc93c",tension:.1});f.push({label:l.avgattendance,data:g,fill:!1,borderColor:"#1687a7",backgroundColor:"#1687a7",tension:.1});new e(a,{type:"line",data:{labels:d,datasets:f},options:{responsive:!0,maintainAspectRatio:!1},plugins:[{id:"custom_canvas_background_color",beforeDraw:function beforeDraw(a){var b=a.canvas.getContext("2d");b.save();b.globalCompositeOperation="destination-over";b.fillStyle="#f6f5f5";b.fillRect(0,0,a.width,a.height);b.restore()}}]})};f.prototype.setupEvents=function(){var b=this;a(".grade-history").on("custom.getGradeHistory",function(){b.getGradeHistory()});a(".grade-history").click(function(){a(this).trigger("custom.getGradeHistory")});a(".grade-history").on("custom.historyHideCarretHandler",function(){b.historyHideCarretHandler()});a(".grade-effort").on("custom.getEffortHistory",function(){b.getEffortHistory()});a(".grade-effort").click(function(){a(this).trigger("custom.getEffortHistory")});a(".grade-effort").on("custom.effortHideCarretHandler",function(){b.effortHideCarretHandler()})};f.prototype.getGradeHistory=function(){var d=this,e=d.username;a("#grade-history-table").removeAttr("hidden");a("#history-show").toggle();a("#history-hide").toggle();b.call([{methodname:"block_grades_effort_report_get_context",args:{table:"grades",username:e},done:function done(b){var c=b.html,d=a("[data-region=\"grade-history\"]");a("#grade-history-table").attr("hidden",!0);d.replaceWith(c)},fail:function fail(a){c.error("block_grades_effort_report: Unable to get context.");c.debug(a);region.replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}]);a(".grade-history").off("custom.getGradeHistory");a(".grade-history").on("click",function(){a(this).trigger("custom.historyHideCarretHandler")})};f.prototype.getEffortHistory=function(){var d=this,e=d.username;a("#grade-effort-table").removeAttr("hidden");a("#effort-show").toggle();a("#effort-hide").toggle();b.call([{methodname:"block_grades_effort_report_get_context",args:{table:"effort",username:e},done:function done(b){var c=b.html,d=a("[data-region=\"grade-effort\"]");a("#grade-effort-table").attr("hidden",!0);d.replaceWith(c)},fail:function fail(a){c.error("block_grades_effort_report: Unable to get context.");c.debug(a);region.replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}]);a(".grade-effort").off("custom.getEffortHistory");a(".grade-effort").on("click",function(){a(this).trigger("custom.effortHideCarretHandler")})};f.prototype.historyHideCarretHandler=function(){a("#history-hide").toggle();a("#history-show").toggle();console.log("CLICK historyHideCarretHandler")};f.prototype.effortHideCarretHandler=function(){a("#effort-hide").toggle();a("#effort-show").toggle();console.log("CLICK effortHideCarretHandler")};return{init:function(){var a=document.querySelector(".grade-effort-trend"),b=a.getAttribute("data-username"),c=new f(b);c.main()}}});
//# sourceMappingURL=controls.min.js.map
