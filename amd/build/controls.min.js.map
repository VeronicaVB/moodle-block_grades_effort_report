{"version":3,"sources":["../src/controls.js"],"names":["define","$","Ajax","Log","Chart","Controls","prototype","main","self","trendChart","ctx","document","getElementById","performanceEl","querySelector","dataset","performance","pEl","createElement","innerHTML","parentNode","replaceChild","JSON","parse","console","log","labels","sets","attendance","effort","grades","gradeperterm","TAGS","avgattendance","avgeffort","avggrades","avgradeterm","i","length","p","year","details","toString","term","push","label","data","fill","borderColor","backgroundColor","tension","type","datasets","options","responsive","maintainAspectRatio","plugins","id","beforeDraw","chart","canvas","getContext","save","globalCompositeOperation","fillStyle","fillRect","width","height","restore","init","control"],"mappings":"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","sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package   block_grades_effort_report\n * @copyright 2021 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/log', 'block_grades_effort_report/chart'], function ($, Ajax, Log, Chart) {\n    'use strict';\n\n    function init() {\n        var control = new Controls();\n        control.main();\n    }\n\n    /**\n    * Controls a single block_grades_effort_report block instance contents.\n    *\n    * @constructor\n    */\n    function Controls() {\n        \n    }\n\n    /**\n     * Run the controller.\n     *\n     */\n    Controls.prototype.main = function () {\n        let self = this;\n        self.trendChart();\n\n    };\n\n    Controls.prototype.trendChart = function () {\n\n        const ctx = document.getElementById(\"trendChart\");\n        const performanceEl = document.querySelector(\"#performance\");\n        if (performanceEl.dataset.performance === \"\") { // no data available.\n            const pEl = document.createElement('p');\n            pEl.innerHTML = 'Trend Data not available';\n            ctx.parentNode.replaceChild(pEl, ctx);\n            return;\n        }\n        const performance = JSON.parse(performanceEl.dataset.performance);\n        console.log(performance);\n        let labels = [];\n        let sets = [];\n        let attendance = [];\n        let effort = [];\n        let grades = [];\n        let gradeperterm = [];\n\n        const TAGS = {\n            avgattendance: 'Average Attendance',\n            avgeffort: 'Average Effort',\n            avggrades: 'Average Grade',\n            avgradeterm: 'Average Grade',\n        }\n\n        for (let i = 0; i < performance.length; i++) {\n            var p = performance[i];\n\n            const year = p.details.year.toString();\n            const term = p.details.term.toString();\n\n            labels.push(['T' + term, year]);\n            gradeperterm.push(p.details.avggrades);\n\n            grades.push(p.details.avggrades);\n            effort.push(p.details.avgeffort)\n            attendance.push(p.details.avgattendance)\n\n        }\n\n        sets.push({\n            label: TAGS.avggrades,\n            data: grades,\n            fill: false,\n            borderColor: '#31326f',\n            backgroundColor: '#31326f',\n            tension: 0.1,\n        });\n\n        sets.push({\n            label: TAGS.avgeffort,\n            data: effort,\n            fill: false,\n            borderColor: '#ffc93c',\n            backgroundColor: '#ffc93c',\n            tension: 0.1\n        });\n\n        sets.push({\n            label: TAGS.avgattendance,\n            data: attendance,\n            fill: false,\n            borderColor: '#1687a7',\n            backgroundColor: '#1687a7',\n            tension: 0.1\n        });\n\n        const data = {\n            labels: labels,\n            datasets: sets\n        };\n\n        const options = {\n            responsive: true,\n            maintainAspectRatio: false,\n\n        }\n\n        const plugin = {\n            id: 'custom_canvas_background_color',\n            beforeDraw: (chart) => {\n                const ctx = chart.canvas.getContext('2d');\n                ctx.save();\n                ctx.globalCompositeOperation = 'destination-over';\n                ctx.fillStyle = '#f6f5f5';\n                ctx.fillRect(0, 0, chart.width, chart.height);\n                ctx.restore();\n            }\n        };\n\n        var myLineChart = new Chart(ctx, {\n            type: 'line',\n            data: data,\n            options: options,\n            plugins: [plugin],\n\n        });\n\n    };\n    \n\n    return { init: init }\n});\n"],"file":"controls.min.js"}